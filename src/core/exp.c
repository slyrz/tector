#include "config.h"
#include "exp.h"

#include <math.h>

static float exp_table[1024] = {
  0.0024726232f, 0.0025016967f, 0.0025311113f, 0.0025608708f, 0.0025909794f,
  0.0026214409f, 0.0026522597f, 0.0026834398f, 0.0027149855f, 0.0027469009f,
  0.0027791906f, 0.0028118587f, 0.0028449097f, 0.0028783480f, 0.0029121783f,
  0.0029464050f, 0.0029810327f, 0.0030160662f, 0.0030515102f, 0.0030873693f,
  0.0031236486f, 0.0031603528f, 0.0031974869f, 0.0032350560f, 0.0032730650f,
  0.0033115191f, 0.0033504234f, 0.0033897833f, 0.0034296039f, 0.0034698907f,
  0.0035106491f, 0.0035518845f, 0.0035936026f, 0.0036358088f, 0.0036785089f,
  0.0037217087f, 0.0037654138f, 0.0038096302f, 0.0038543638f, 0.0038996207f,
  0.0039454068f, 0.0039917284f, 0.0040385916f, 0.0040860027f, 0.0041339681f,
  0.0041824942f, 0.0042315875f, 0.0042812545f, 0.0043315020f, 0.0043823366f,
  0.0044337652f, 0.0044857946f, 0.0045384317f, 0.0045916837f, 0.0046455575f,
  0.0047000605f, 0.0047551999f, 0.0048109830f, 0.0048674173f, 0.0049245104f,
  0.0049822697f, 0.0050407031f, 0.0050998183f, 0.0051596232f, 0.0052201257f,
  0.0052813339f, 0.0053432560f, 0.0054059001f, 0.0054692746f, 0.0055333879f,
  0.0055982486f, 0.0056638652f, 0.0057302465f, 0.0057974013f, 0.0058653384f,
  0.0059340668f, 0.0060035958f, 0.0060739344f, 0.0061450921f, 0.0062170781f,
  0.0062899021f, 0.0063635737f, 0.0064381026f, 0.0065134986f, 0.0065897717f,
  0.0066669319f, 0.0067449895f, 0.0068239548f, 0.0069038381f, 0.0069846499f,
  0.0070664010f, 0.0071491020f, 0.0072327638f, 0.0073173975f, 0.0074030141f,
  0.0074896249f, 0.0075772413f, 0.0076658747f, 0.0077555368f, 0.0078462393f,
  0.0079379941f, 0.0080308132f, 0.0081247088f, 0.0082196931f, 0.0083157785f,
  0.0084129776f, 0.0085113030f, 0.0086107677f, 0.0087113845f, 0.0088131665f,
  0.0089161271f, 0.0090202795f, 0.0091256374f, 0.0092322144f, 0.0093400244f,
  0.0094490813f, 0.0095593993f, 0.0096709928f, 0.0097838760f, 0.0098980637f,
  0.0100135706f, 0.0101304117f, 0.0102486019f, 0.0103681567f, 0.0104890913f,
  0.0106114213f, 0.0107351626f, 0.0108603310f, 0.0109869426f, 0.0111150137f,
  0.0112445607f, 0.0113756002f, 0.0115081491f, 0.0116422242f, 0.0117778427f,
  0.0119150220f, 0.0120537795f, 0.0121941330f, 0.0123361004f, 0.0124796997f,
  0.0126249493f, 0.0127718675f, 0.0129204730f, 0.0130707848f, 0.0132228218f,
  0.0133766032f, 0.0135321487f, 0.0136894777f, 0.0138486102f, 0.0140095663f,
  0.0141723662f, 0.0143370304f, 0.0145035797f, 0.0146720349f, 0.0148424172f,
  0.0150147480f, 0.0151890488f, 0.0153653414f, 0.0155436479f, 0.0157239905f,
  0.0159063917f, 0.0160908742f, 0.0162774609f, 0.0164661750f, 0.0166570400f,
  0.0168500794f, 0.0170453173f, 0.0172427776f, 0.0174424847f, 0.0176444634f,
  0.0178487384f, 0.0180553350f, 0.0182642784f, 0.0184755942f, 0.0186893084f,
  0.0189054471f, 0.0191240368f, 0.0193451039f, 0.0195686756f, 0.0197947789f,
  0.0200234413f, 0.0202546906f, 0.0204885547f, 0.0207250619f, 0.0209642408f,
  0.0212061202f, 0.0214507292f, 0.0216980971f, 0.0219482537f, 0.0222012289f,
  0.0224570529f, 0.0227157563f, 0.0229773699f, 0.0232419248f, 0.0235094524f,
  0.0237799844f, 0.0240535529f, 0.0243301901f, 0.0246099286f, 0.0248928014f,
  0.0251788417f, 0.0254680830f, 0.0257605591f, 0.0260563043f, 0.0263553528f,
  0.0266577397f, 0.0269634999f, 0.0272726688f, 0.0275852822f, 0.0279013762f,
  0.0282209871f, 0.0285441517f, 0.0288709069f, 0.0292012902f, 0.0295353393f,
  0.0298730921f, 0.0302145871f, 0.0305598629f, 0.0309089585f, 0.0312619134f,
  0.0316187673f, 0.0319795601f, 0.0323443324f, 0.0327131248f, 0.0330859784f,
  0.0334629347f, 0.0338440353f, 0.0342293226f, 0.0346188388f, 0.0350126269f,
  0.0354107301f, 0.0358131918f, 0.0362200559f, 0.0366313666f, 0.0370471687f,
  0.0374675069f, 0.0378924266f, 0.0383219735f, 0.0387561936f, 0.0391951332f,
  0.0396388391f, 0.0400873584f, 0.0405407385f, 0.0409990272f, 0.0414622727f,
  0.0419305236f, 0.0424038286f, 0.0428822372f, 0.0433657988f, 0.0438545634f,
  0.0443485814f, 0.0448479034f, 0.0453525806f, 0.0458626642f, 0.0463782060f,
  0.0468992582f, 0.0474258732f, 0.0479581038f, 0.0484960032f, 0.0490396250f,
  0.0495890230f, 0.0501442514f, 0.0507053648f, 0.0512724181f, 0.0518454666f,
  0.0524245660f, 0.0530097720f, 0.0536011411f, 0.0541987298f, 0.0548025952f,
  0.0554127944f, 0.0560293851f, 0.0566524253f, 0.0572819732f, 0.0579180874f,
  0.0585608269f, 0.0592102507f, 0.0598664186f, 0.0605293902f, 0.0611992258f,
  0.0618759857f, 0.0625597308f, 0.0632505220f, 0.0639484207f, 0.0646534884f,
  0.0653657870f, 0.0660853787f, 0.0668123258f, 0.0675466911f, 0.0682885375f,
  0.0690379282f, 0.0697949265f, 0.0705595962f, 0.0713320011f, 0.0721122054f,
  0.0729002734f, 0.0736962697f, 0.0745002590f, 0.0753123063f, 0.0761324768f,
  0.0769608357f, 0.0777974486f, 0.0786423812f, 0.0794956993f, 0.0803574688f,
  0.0812277560f, 0.0821066270f, 0.0829941484f, 0.0838903864f, 0.0847954078f,
  0.0857092793f, 0.0866320676f, 0.0875638395f, 0.0885046621f, 0.0894546022f,
  0.0904137268f, 0.0913821031f, 0.0923597979f, 0.0933468785f, 0.0943434118f,
  0.0953494649f, 0.0963651047f, 0.0973903983f, 0.0984254124f, 0.0994702139f,
  0.1005248695f, 0.1015894459f, 0.1026640096f, 0.1037486269f, 0.1048433640f,
  0.1059482871f, 0.1070634621f, 0.1081889546f, 0.1093248301f, 0.1104711539f,
  0.1116279910f, 0.1127954063f, 0.1139734641f, 0.1151622287f, 0.1163617640f,
  0.1175721335f, 0.1187934005f, 0.1200256278f, 0.1212688777f, 0.1225232125f,
  0.1237886937f, 0.1250653825f, 0.1263533396f, 0.1276526253f, 0.1289632993f,
  0.1302854207f, 0.1316190484f, 0.1329642402f, 0.1343210538f, 0.1356895460f,
  0.1370697730f, 0.1384617906f, 0.1398656535f, 0.1412814160f, 0.1427091316f,
  0.1441488530f, 0.1456006323f, 0.1470645205f, 0.1485405680f, 0.1500288243f,
  0.1515293382f, 0.1530421572f, 0.1545673284f, 0.1561048974f, 0.1576549094f,
  0.1592174081f, 0.1607924366f, 0.1623800367f, 0.1639802491f, 0.1655931136f,
  0.1672186688f, 0.1688569521f, 0.1705079998f, 0.1721718470f, 0.1738485274f,
  0.1755380736f, 0.1772405171f, 0.1789558877f, 0.1806842142f, 0.1824255238f,
  0.1841798425f, 0.1859471949f, 0.1877276040f, 0.1895210913f, 0.1913276771f,
  0.1931473800f, 0.1949802170f, 0.1968262036f, 0.1986853538f, 0.2005576797f,
  0.2024431921f, 0.2043418999f, 0.2062538104f, 0.2081789291f, 0.2101172597f,
  0.2120688044f, 0.2140335632f, 0.2160115347f, 0.2180027153f, 0.2200070997f,
  0.2220246808f, 0.2240554492f, 0.2260993940f, 0.2281565022f, 0.2302267585f,
  0.2323101461f, 0.2344066458f, 0.2365162364f, 0.2386388949f, 0.2407745958f,
  0.2429233117f, 0.2450850131f, 0.2472596683f, 0.2494472435f, 0.2516477024f,
  0.2538610070f, 0.2560871166f, 0.2583259886f, 0.2605775779f, 0.2628418374f,
  0.2651187174f, 0.2674081662f, 0.2697101296f, 0.2720245511f, 0.2743513720f,
  0.2766905310f, 0.2790419648f, 0.2814056074f, 0.2837813907f, 0.2861692440f,
  0.2885690943f, 0.2909808662f, 0.2934044820f, 0.2958398616f, 0.2982869222f,
  0.3007455789f, 0.3032157444f, 0.3056973288f, 0.3081902400f, 0.3106943832f,
  0.3132096615f, 0.3157359755f, 0.3182732234f, 0.3208213008f, 0.3233801013f,
  0.3259495159f, 0.3285294333f, 0.3311197396f, 0.3337203190f, 0.3363310529f,
  0.3389518208f, 0.3415824994f, 0.3442229636f, 0.3468730858f, 0.3495327360f,
  0.3522017820f, 0.3548800897f, 0.3575675224f, 0.3602639413f, 0.3629692055f,
  0.3656831720f, 0.3684056956f, 0.3711366290f, 0.3738758228f, 0.3766231256f,
  0.3793783841f, 0.3821414429f, 0.3849121445f, 0.3876903297f, 0.3904758374f,
  0.3932685046f, 0.3960681663f, 0.3988746559f, 0.4016878051f, 0.4045074438f,
  0.4073334000f, 0.4101655006f, 0.4130035703f, 0.4158474326f, 0.4186969094f,
  0.4215518211f, 0.4244119867f, 0.4272772238f, 0.4301473486f, 0.4330221761f,
  0.4359015200f, 0.4387851927f, 0.4416730057f, 0.4445647690f, 0.4474602919f,
  0.4503593825f, 0.4532618480f, 0.4561674946f, 0.4590761278f, 0.4619875521f,
  0.4649015714f, 0.4678179887f, 0.4707366066f, 0.4736572270f, 0.4765796511f,
  0.4795036797f, 0.4824291134f, 0.4853557520f, 0.4882833953f, 0.4912118426f,
  0.4941408932f, 0.4970703460f, 0.5000000000f, 0.5029296540f, 0.5058591068f,
  0.5087881574f, 0.5117166047f, 0.5146442480f, 0.5175708866f, 0.5204963203f,
  0.5234203489f, 0.5263427730f, 0.5292633934f, 0.5321820113f, 0.5350984286f,
  0.5380124479f, 0.5409238722f, 0.5438325054f, 0.5467381520f, 0.5496406175f,
  0.5525397081f, 0.5554352310f, 0.5583269943f, 0.5612148073f, 0.5640984800f,
  0.5669778239f, 0.5698526514f, 0.5727227762f, 0.5755880133f, 0.5784481789f,
  0.5813030906f, 0.5841525674f, 0.5869964297f, 0.5898344994f, 0.5926666000f,
  0.5954925562f, 0.5983121949f, 0.6011253441f, 0.6039318337f, 0.6067314954f,
  0.6095241626f, 0.6123096703f, 0.6150878555f, 0.6178585571f, 0.6206216159f,
  0.6233768744f, 0.6261241772f, 0.6288633710f, 0.6315943044f, 0.6343168280f,
  0.6370307945f, 0.6397360587f, 0.6424324776f, 0.6451199103f, 0.6477982180f,
  0.6504672640f, 0.6531269142f, 0.6557770364f, 0.6584175006f, 0.6610481792f,
  0.6636689471f, 0.6662796810f, 0.6688802604f, 0.6714705667f, 0.6740504841f,
  0.6766198987f, 0.6791786992f, 0.6817267766f, 0.6842640245f, 0.6867903385f,
  0.6893056168f, 0.6918097600f, 0.6943026712f, 0.6967842556f, 0.6992544211f,
  0.7017130778f, 0.7041601384f, 0.7065955180f, 0.7090191338f, 0.7114309057f,
  0.7138307560f, 0.7162186093f, 0.7185943926f, 0.7209580352f, 0.7233094690f,
  0.7256486280f, 0.7279754489f, 0.7302898704f, 0.7325918338f, 0.7348812826f,
  0.7371581626f, 0.7394224221f, 0.7416740114f, 0.7439128834f, 0.7461389930f,
  0.7483522976f, 0.7505527565f, 0.7527403317f, 0.7549149869f, 0.7570766883f,
  0.7592254042f, 0.7613611051f, 0.7634837636f, 0.7655933542f, 0.7676898539f,
  0.7697732415f, 0.7718434978f, 0.7739006060f, 0.7759445508f, 0.7779753192f,
  0.7799929003f, 0.7819972847f, 0.7839884653f, 0.7859664368f, 0.7879311956f,
  0.7898827403f, 0.7918210709f, 0.7937461896f, 0.7956581001f, 0.7975568079f,
  0.7994423203f, 0.8013146462f, 0.8031737964f, 0.8050197830f, 0.8068526200f,
  0.8086723229f, 0.8104789087f, 0.8122723960f, 0.8140528051f, 0.8158201575f,
  0.8175744762f, 0.8193157858f, 0.8210441123f, 0.8227594829f, 0.8244619264f,
  0.8261514726f, 0.8278281530f, 0.8294920002f, 0.8311430479f, 0.8327813312f,
  0.8344068864f, 0.8360197509f, 0.8376199633f, 0.8392075634f, 0.8407825919f,
  0.8423450906f, 0.8438951026f, 0.8454326716f, 0.8469578428f, 0.8484706618f,
  0.8499711757f, 0.8514594320f, 0.8529354795f, 0.8543993677f, 0.8558511470f,
  0.8572908684f, 0.8587185840f, 0.8601343465f, 0.8615382094f, 0.8629302270f,
  0.8643104540f, 0.8656789462f, 0.8670357598f, 0.8683809516f, 0.8697145793f,
  0.8710367007f, 0.8723473747f, 0.8736466604f, 0.8749346175f, 0.8762113063f,
  0.8774767875f, 0.8787311223f, 0.8799743722f, 0.8812065995f, 0.8824278665f,
  0.8836382360f, 0.8848377713f, 0.8860265359f, 0.8872045937f, 0.8883720090f,
  0.8895288461f, 0.8906751699f, 0.8918110454f, 0.8929365379f, 0.8940517129f,
  0.8951566360f, 0.8962513731f, 0.8973359904f, 0.8984105541f, 0.8994751305f,
  0.9005297861f, 0.9015745876f, 0.9026096017f, 0.9036348953f, 0.9046505351f,
  0.9056565882f, 0.9066531215f, 0.9076402021f, 0.9086178969f, 0.9095862732f,
  0.9105453978f, 0.9114953379f, 0.9124361605f, 0.9133679324f, 0.9142907207f,
  0.9152045922f, 0.9161096136f, 0.9170058516f, 0.9178933730f, 0.9187722440f,
  0.9196425312f, 0.9205043007f, 0.9213576188f, 0.9222025514f, 0.9230391643f,
  0.9238675232f, 0.9246876937f, 0.9254997410f, 0.9263037303f, 0.9270997266f,
  0.9278877946f, 0.9286679989f, 0.9294404038f, 0.9302050735f, 0.9309620718f,
  0.9317114625f, 0.9324533089f, 0.9331876742f, 0.9339146213f, 0.9346342130f,
  0.9353465116f, 0.9360515793f, 0.9367494780f, 0.9374402692f, 0.9381240143f,
  0.9388007742f, 0.9394706098f, 0.9401335814f, 0.9407897493f, 0.9414391731f,
  0.9420819126f, 0.9427180268f, 0.9433475747f, 0.9439706149f, 0.9445872056f,
  0.9451974048f, 0.9458012702f, 0.9463988589f, 0.9469902280f, 0.9475754340f,
  0.9481545334f, 0.9487275819f, 0.9492946352f, 0.9498557486f, 0.9504109770f,
  0.9509603750f, 0.9515039968f, 0.9520418962f, 0.9525741268f, 0.9531007418f,
  0.9536217940f, 0.9541373358f, 0.9546474194f, 0.9551520966f, 0.9556514186f,
  0.9561454366f, 0.9566342012f, 0.9571177628f, 0.9575961714f, 0.9580694764f,
  0.9585377273f, 0.9590009728f, 0.9594592615f, 0.9599126416f, 0.9603611609f,
  0.9608048668f, 0.9612438064f, 0.9616780265f, 0.9621075734f, 0.9625324931f,
  0.9629528313f, 0.9633686334f, 0.9637799441f, 0.9641868082f, 0.9645892699f,
  0.9649873731f, 0.9653811612f, 0.9657706774f, 0.9661559647f, 0.9665370653f,
  0.9669140216f, 0.9672868752f, 0.9676556676f, 0.9680204399f, 0.9683812327f,
  0.9687380866f, 0.9690910415f, 0.9694401371f, 0.9697854129f, 0.9701269079f,
  0.9704646607f, 0.9707987098f, 0.9711290931f, 0.9714558483f, 0.9717790129f,
  0.9720986238f, 0.9724147178f, 0.9727273312f, 0.9730365001f, 0.9733422603f,
  0.9736446472f, 0.9739436957f, 0.9742394409f, 0.9745319170f, 0.9748211583f,
  0.9751071986f, 0.9753900714f, 0.9756698099f, 0.9759464471f, 0.9762200156f,
  0.9764905476f, 0.9767580752f, 0.9770226301f, 0.9772842437f, 0.9775429471f,
  0.9777987711f, 0.9780517463f, 0.9783019029f, 0.9785492708f, 0.9787938798f,
  0.9790357592f, 0.9792749381f, 0.9795114453f, 0.9797453094f, 0.9799765587f,
  0.9802052211f, 0.9804313244f, 0.9806548961f, 0.9808759632f, 0.9810945529f,
  0.9813106916f, 0.9815244058f, 0.9817357216f, 0.9819446650f, 0.9821512616f,
  0.9823555366f, 0.9825575153f, 0.9827572224f, 0.9829546827f, 0.9831499206f,
  0.9833429600f, 0.9835338250f, 0.9837225391f, 0.9839091258f, 0.9840936083f,
  0.9842760095f, 0.9844563521f, 0.9846346586f, 0.9848109512f, 0.9849852520f,
  0.9851575828f, 0.9853279651f, 0.9854964203f, 0.9856629696f, 0.9858276338f,
  0.9859904337f, 0.9861513898f, 0.9863105223f, 0.9864678513f, 0.9866233968f,
  0.9867771782f, 0.9869292152f, 0.9870795270f, 0.9872281325f, 0.9873750507f,
  0.9875203003f, 0.9876638996f, 0.9878058670f, 0.9879462205f, 0.9880849780f,
  0.9882221573f, 0.9883577758f, 0.9884918509f, 0.9886243998f, 0.9887554393f,
  0.9888849863f, 0.9890130574f, 0.9891396690f, 0.9892648374f, 0.9893885787f,
  0.9895109087f, 0.9896318433f, 0.9897513981f, 0.9898695883f, 0.9899864294f,
  0.9901019363f, 0.9902161240f, 0.9903290072f, 0.9904406007f, 0.9905509187f,
  0.9906599756f, 0.9907677856f, 0.9908743626f, 0.9909797205f, 0.9910838729f,
  0.9911868335f, 0.9912886155f, 0.9913892323f, 0.9914886970f, 0.9915870224f,
  0.9916842215f, 0.9917803069f, 0.9918752912f, 0.9919691868f, 0.9920620059f,
  0.9921537607f, 0.9922444632f, 0.9923341253f, 0.9924227587f, 0.9925103751f,
  0.9925969859f, 0.9926826025f, 0.9927672362f, 0.9928508980f, 0.9929335990f,
  0.9930153501f, 0.9930961619f, 0.9931760452f, 0.9932550105f, 0.9933330681f,
  0.9934102283f, 0.9934865014f, 0.9935618974f, 0.9936364263f, 0.9937100979f,
  0.9937829219f, 0.9938549079f, 0.9939260656f, 0.9939964042f, 0.9940659332f,
  0.9941346616f, 0.9942025987f, 0.9942697535f, 0.9943361348f, 0.9944017514f,
  0.9944666121f, 0.9945307254f, 0.9945940999f, 0.9946567440f, 0.9947186661f,
  0.9947798743f, 0.9948403768f, 0.9949001817f, 0.9949592969f, 0.9950177303f,
  0.9950754896f, 0.9951325827f, 0.9951890170f, 0.9952448001f, 0.9952999395f,
  0.9953544425f, 0.9954083163f, 0.9954615683f, 0.9955142054f, 0.9955662348f,
  0.9956176634f, 0.9956684980f, 0.9957187455f, 0.9957684125f, 0.9958175058f,
  0.9958660319f, 0.9959139973f, 0.9959614084f, 0.9960082716f, 0.9960545932f,
  0.9961003793f, 0.9961456362f, 0.9961903698f, 0.9962345862f, 0.9962782913f,
  0.9963214911f, 0.9963641912f, 0.9964063974f, 0.9964481155f, 0.9964893509f,
  0.9965301093f, 0.9965703961f, 0.9966102167f, 0.9966495766f, 0.9966884809f,
  0.9967269350f, 0.9967649440f, 0.9968025131f, 0.9968396472f, 0.9968763514f,
  0.9969126307f, 0.9969484898f, 0.9969839338f, 0.9970189673f, 0.9970535950f,
  0.9970878217f, 0.9971216520f, 0.9971550903f, 0.9971881413f, 0.9972208094f,
  0.9972530991f, 0.9972850145f, 0.9973165602f, 0.9973477403f, 0.9973785591f,
  0.9974090206f, 0.9974391292f, 0.9974688887f, 0.9974983033f,
};

float
exptabf (float x)
{
  if (fabsf (x) >= 6.0f)
    return -1.0f;
  return exp_table[(int) ((x + 6.0f) * (1024.0f / 6.0f / 2.0f))];
}
